(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{132:function(e,t,a){},134:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),c=a(16),i=a.n(c),s=a(3),o=a(4),l=a(7),u=a(5),m=a(6),p=a(23),d=a(15),h=a(10),v=a(35),b=a.n(v),f="https://api.themoviedb.org/3",g="942fe0c9aeb6728941df8e74f3fbce09",E=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise(function(a,n){fetch(e,t).then(function(e){if(e.status<400)return e.json();throw e}).then(function(e){a(e)}).catch(function(e){e.json().then(function(e){n(e)})})})},O=function(){function e(){Object(s.a)(this,e)}return Object(o.a)(e,null,[{key:"get",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).params,a=void 0===t?{}:t,n=Object(h.a)({api_key:g,language:"ru-RU"},a);return E("".concat(f).concat(e,"?").concat(b.a.stringify(n)),{mode:"cors",headers:{"Content-type":"application/json"}})}},{key:"post",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.params,n=void 0===a?{}:a,r=t.body,c=void 0===r?{}:r,i=Object(h.a)({api_key:g,language:"ru-RU"},n);return E("".concat(f).concat(e,"?").concat(b.a.stringify(i)),{method:"POST",mode:"cors",headers:{"Content-type":"application/json"},body:JSON.stringify(c)})}},{key:"delete",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.params,n=void 0===a?{}:a,r=t.body,c=void 0===r?{}:r,i=Object(h.a)({api_key:g,language:"ru-RU"},n);return E("".concat(f).concat(e,"?").concat(b.a.stringify(i)),{method:"Delete",mode:"cors",headers:{"Content-type":"application/json"},body:JSON.stringify(c)})}}]),e}(),j=a(8),y=a(9),_=function(e){return function(t){var a=e.session_id;O.get("/account",{params:{session_id:a}}).then(function(e){t(k({user:e,session_id:a}))})}},k=function(e){return{type:"UPDATE_AUTH",payload:{user:e.user,session_id:e.session_id}}},w=function(){return{type:"LOG_OUT"}},N=function(e){var t=e.session_id,a=e.user_id;return function(e){var n={session_id:t};O.get("/account/".concat(a,"/favorite/movies"),{params:n}).then(function(t){e(A(t))})}},C=function(e){var t=e.session_id,a=e.user_id;return function(e){var n={session_id:t};O.get("/account/".concat(a,"/watchlist/movies"),{params:n}).then(function(t){e(F(t))})}},A=function(e){return{type:"UPDATE_FAVORITE",payload:e.results}},F=function(e){return{type:"UPDATE_WATCHLIST",payload:e.results}},S=function(){return{type:"TOGGLE_LOGIN_FORM"}},M=function(){return{type:"HIDE_LOGIN_FORM"}},L=function(e){return{type:"CHANGE_PAGE",payload:e}},P=function(e,t){return function(a){var n=e.sort_by,r=e.primary_release_year,c=e.with_genres,i={sort_by:n,language:"ru-RU",page:t,primary_release_year:r,with_genres:c};c&&(i.with_genres=c.join(",")),a({type:"FETCHING_MOVIES"}),O.get("/discover/movie",{params:i}).then(function(e){a(function(e){return{type:"UPDATE_MOVIES",payload:e}}(e))}).catch(function(e){a({type:"ERROR_GET_MOVIES",payload:e})})}},R=function(e){return{type:"UPDATE_FILTERS",payload:e}},T=function(e){return{type:"RESET_FILTERS"}},D=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={username:"",password:"",repeatPassword:"",errors:{},submitting:!1},a.onChange=function(e){var t=e.target.name,n=e.target.value;a.setState(function(e){var a,r;return r={},Object(d.a)(r,t,n),Object(d.a)(r,"errors",Object(h.a)({},e.errors,(a={},Object(d.a)(a,t,null),Object(d.a)(a,"base",null),a))),r})},a.handleBlur=function(e){var t=a.validateFields(),n=e.target.name;t[n]&&a.setState(function(e){return{errors:Object(h.a)({},e.errors,Object(d.a)({},n,t[n]))}})},a.validateFields=function(){var e={};return""===a.state.username&&(e.username="Not empty"),a.state.password!==a.state.repeatPassword&&(e.repeatPassword="Password must be the same"),a.state.password.length<5&&(e.password="Password must be at least 5 character"),e},a.onSubmit=function(){console.log(a.props),a.setState({submitting:!0});var e=null;O.get("/authentication/token/new").then(function(e){return O.post("/authentication/token/validate_with_login",{body:{username:a.state.username,password:a.state.password,request_token:e.request_token}})}).then(function(e){return O.post("/authentication/session/new",{body:{request_token:e.request_token}})}).then(function(t){return e=t.session_id,O.get("/account",{params:{session_id:t.session_id}})}).then(function(t){a.setState({submitting:!1},function(){a.props.updateAuth({user:t,session_id:e})})}).catch(function(e){console.log("error",e),a.setState({submitting:!1,errors:{base:e.status_message}})})},a.onLogin=function(e){e.preventDefault();var t=a.validateFields();Object.keys(t).length>0?a.setState(function(e){return{errors:Object(h.a)({},e.errors,t)}}):a.onSubmit()},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentWillUnmount",value:function(){this.props.hideLoginForm()}},{key:"render",value:function(){var e=this.state,t=e.username,a=e.password,n=e.repeatPassword,c=e.errors,i=e.submitting;return r.a.createElement("div",{className:"form-login-container"},r.a.createElement("form",{className:"form-login"},r.a.createElement("h1",{className:"h3 mb-3 font-weight-normal text-center"},"\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f"),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"username"},"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c"),r.a.createElement("input",{type:"text",className:"form-control",id:"username",placeholder:"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c",name:"username",value:t,onChange:this.onChange,onBlur:this.handleBlur}),c.username&&r.a.createElement("div",{className:"invalid-feedback"},c.username)),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"password"},"\u041f\u0430\u0440\u043e\u043b\u044c"),r.a.createElement("input",{type:"password",className:"form-control",id:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",name:"password",value:a,onBlur:this.handleBlur,onChange:this.onChange}),c.password&&r.a.createElement("div",{className:"invalid-feedback"},c.password)),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"repeatPassword"},"\u041f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c"),r.a.createElement("input",{type:"password",className:"form-control",id:"repeatPassword",placeholder:"\u041f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c",name:"repeatPassword",value:n,onChange:this.onChange,onBlur:this.handleBlur}),c.repeatPassword&&r.a.createElement("div",{className:"invalid-feedback"},c.repeatPassword)),r.a.createElement("button",{type:"submit",className:"btn btn-lg btn-primary btn-block",onClick:this.onLogin,disabled:i},"\u0412\u0445\u043e\u0434"),c.base&&r.a.createElement("div",{className:"invalid-feedback text-center"},c.base)))}}]),t}(r.a.Component),G=Object(y.b)(function(){return{}},function(e){return Object(j.bindActionCreators)({updateAuth:k,hideLoginForm:M},e)})(D),I=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props,t=e.toggleLoginForm,a=e.showLoginForm;return r.a.createElement("div",null,r.a.createElement("button",{className:"btn btn-success",type:"button",onClick:t},"Login"),r.a.createElement(p.d,{isOpen:a,toggle:t},r.a.createElement(p.e,null,r.a.createElement(G,null))))}}]),t}(n.Component),U=Object(y.b)(function(e){return{showLoginForm:e.modals.showLoginForm}},function(e){return Object(j.bindActionCreators)({toggleLoginForm:S},e)})(I),x=a(14),H=a(78),W=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).logOut=function(){a.props.closeMenu();var e=a.props,t=e.session_id,n=e.onLogOut;O.delete("/authentication/session?",{body:{session_id:t}}).then(function(e){var t=e.success;void 0!==t&&t&&n()})},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props.closeMenu;return r.a.createElement("div",{className:"dropdown-menu"},r.a.createElement("h6",{className:"dropdown-header"},"\u041c\u0435\u043d\u044e"),r.a.createElement("div",{className:"dropdown-divider"}),r.a.createElement("span",{className:"dropdown-item",onClick:this.logOut},"\u0412\u044b\u0439\u0442\u0438"),r.a.createElement("span",{className:"dropdown-item"},r.a.createElement(H.a,{to:"/account/favorites",onClick:e},"\u0418\u0437\u0431\u0440\u0430\u043d\u043d\u044b\u0435")),r.a.createElement("span",{className:"dropdown-item"},r.a.createElement(H.a,{to:"/account/watchlist",onClick:e},"\u041a \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0443")))}}]),t}(r.a.Component),B=Object(y.b)(function(e){return{session_id:e.authentication.session_id}},function(e){return Object(j.bindActionCreators)({onLogOut:w},e)})(W),q=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).call(this))).closeMenu=function(){e.setState({showMenu:!1})},e.state={showMenu:!1},e.setWrapperRef=e.setWrapperRef.bind(Object(x.a)(Object(x.a)(e))),e.handleClickOutside=e.handleClickOutside.bind(Object(x.a)(Object(x.a)(e))),e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.handleClickOutside)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.handleClickOutside)}},{key:"setWrapperRef",value:function(e){this.wrapperRef=e}},{key:"handleClickOutside",value:function(e){this.state.showMenu&&this.wrapperRef&&!this.wrapperRef.contains(e.target)&&this.setState({showMenu:!1})}},{key:"render",value:function(){var e=this,t=this.props.user,a=this.state.showMenu;return r.a.createElement("div",{className:"head-user",ref:this.setWrapperRef},r.a.createElement("img",{width:"40",className:"rounded-circle",src:"https://secure.gravatar.com/avatar/".concat(t.avatar.gravatar.hash,".jpg?s=64"),alt:"user avatar",onClick:function(){e.setState({showMenu:!e.state.showMenu})}}),r.a.createElement("div",{className:"user-head__menu"},a&&r.a.createElement(B,{closeMenu:this.closeMenu})))}}]),t}(r.a.Component),V=Object(y.b)(function(e){return{user:e.authentication.user}},function(e){return{}})(q),J=function(e){var t=e.user;return r.a.createElement("nav",{className:"navbar"},r.a.createElement("div",{className:"container"},r.a.createElement("ul",{className:"navbar-nav"},r.a.createElement("li",{className:"nav-item active"},r.a.createElement(H.a,{className:"nav-link header__home-link",to:"/"},"Home"))),t?r.a.createElement(V,null):r.a.createElement(U,null)))},$=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props,t=e.updateFilters,a=e.sort_by,n=e.options;return r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"sort_by"},"\u0421\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e:"),r.a.createElement("select",{className:"form-control",id:"sort_by",name:"sort_by",value:a,onChange:function(e){return t(Object(d.a)({},e.target.name,e.target.value))}},n.map(function(e){return r.a.createElement("option",{key:e.value,value:e.value},e.label)})))}}]),t}(r.a.PureComponent);$.defaultProps={options:[{label:"\u041f\u043e\u043f\u0443\u043b\u044f\u0440\u043d\u044b\u0435 \u043f\u043e \u0443\u0431\u044b\u0432\u0430\u043d\u0438\u044e",value:"popularity.desc"},{label:"\u041f\u043e\u043f\u0443\u043b\u044f\u0440\u043d\u044b\u0435 \u043f\u043e \u0432\u043e\u0437\u0440\u043e\u0441\u0442\u0430\u043d\u0438\u044e",value:"popularity.asc"},{label:"\u0420\u0435\u0439\u0442\u0438\u043d\u0433 \u043f\u043e \u0432\u043e\u0437\u0440\u043e\u0441\u0442\u0430\u043d\u0438\u044e",value:"vote_average.asc"},{label:"\u0420\u0435\u0439\u0442\u0438\u043d\u0433 \u043f\u043e \u0443\u0431\u044b\u0432\u0430\u043d\u0438\u044e",value:"vote_average.desc"}]};var z=Object(y.b)(function(e){return{sort_by:e.movies.filters.sort_by}},function(e){return Object(j.bindActionCreators)({updateFilters:R},e)})($),K=a(26),Q=a.n(K),X=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props,t=e.id,a=e.children;return r.a.createElement("label",{htmlFor:t},a())}}]),t}(r.a.PureComponent),Y=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"shouldComponentUpdate",value:function(e,t){return!Q.a.isEqual(e,this.props)}},{key:"render",value:function(){var e=this.props,t=e.id,a=e.name,n=e.value,c=e.onChange,i=e.label;return r.a.createElement("div",{className:"form-group"},r.a.createElement(X,{id:t},i),r.a.createElement("select",{className:"form-control",id:t,name:a,value:n,onChange:c},this.props.children))}}]),t}(r.a.Component),Z=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props,t=e.updateFilters,a=e.primary_release_year,n=e.options;return r.a.createElement(Y,{id:a,name:"primary_release_year",value:a,onChange:function(e){return t(Object(d.a)({},e.target.name,e.target.value))},label:function(){return r.a.createElement("p",null,"\u0413\u043e\u0434 \u0440\u0435\u043b\u0438\u0437\u0430:")}},n.map(function(e){return r.a.createElement("option",{key:e.value,value:e.value},e.label)}))}}]),t}(r.a.PureComponent);Z.defaultProps={options:[{label:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0433\u043e\u0434",value:"0",image:"./lol.jpg"},{label:"2018",value:"2018"},{label:"2005",value:"2005"},{label:"1991",value:"1991"}]};var ee=Object(y.b)(function(e){return{primary_release_year:e.movies.filters.primary_release_year}},function(e){return Object(j.bindActionCreators)({updateFilters:R},e)})(Z),te=function(e){var t=e.movies;return{page:t.page,total_pages:t.total_pages}},ae=function(e){return Object(j.bindActionCreators)({onChangePage:L},e)},ne=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props,t=e.page,a=e.total_pages,n=e.onChangePage,c=e.mode;return r.a.createElement("div",{className:"text-center ".concat("inline"===c?"d-flex justify-content-end":"")},r.a.createElement("div",{className:"btn-group",role:"group","aria-label":"Basic example"},r.a.createElement("button",{type:"button",className:"btn btn-light",disabled:1===t,onClick:function(){n(t-1)}},"\u041d\u0430\u0437\u0430\u0434"),r.a.createElement("button",{type:"button",className:"btn btn-light",disabled:t===a,onClick:function(){n(t+1)}},"\u0412\u043f\u0435\u0440\u0435\u0434")),r.a.createElement("p",{className:"mt-4 ".concat("inline"===c?"ml-4":"")},r.a.createElement("strong",null,t)," ","of"," ",r.a.createElement("strong",null,a)))}}]),t}(r.a.Component),re=a(62),ce=function(e){return{with_genres:e.movies.filters.with_genres}},ie=function(e){return Object(j.bindActionCreators)({onChangePage:L,updateFilters:R,resetFilters:T},e)},se=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).changeHandler=function(e){a.setState({checked:!a.state.checked}),a.props.onChange(e)},a.state={checked:e.checked},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props,t=e.id,a=e.labelText;return r.a.createElement("div",{className:"custom-control custom-checkbox"},r.a.createElement("input",{type:"checkbox",className:"custom-control-input",id:t,onChange:this.changeHandler,checked:this.state.checked}),r.a.createElement("label",{className:"custom-control-label",htmlFor:t},a))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return{checked:e.checked}}}]),t}(n.PureComponent),oe=function(e){var t=e.allGenres,a=e.onChange,n=e.with_genres;return r.a.createElement("div",{className:"mb-4"},r.a.createElement("ul",null,t.map(function(e){return r.a.createElement("li",{key:e.id},r.a.createElement(se,{id:e.id,labelText:e.name,onChange:a,checked:n.includes(String(e.id))}))})))};oe.defaultProps={allGenres:[],with_genres:[]},oe.displayName="Genres";var le,ue=(le=oe,Object(y.b)(ce,ie)(function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this))).changeHandler=function(e){var t=a.props,n=t.with_genres,r=t.updateFilters,c=e.target.id;r({with_genres:n.includes(c)?n.filter(function(e){return e!==c}):Object(re.a)(n).concat([c])})},a.state={allGenres:[]},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;O.get("/genre/movie/list").then(function(t){e.setState({allGenres:t.genres})})}},{key:"render",value:function(){var e=this.state.allGenres,t=this.props.with_genres;return r.a.createElement(le,{onChange:this.changeHandler,allGenres:e,with_genres:t})}}]),t}(r.a.Component))),me=function(e){return Object(y.b)(te,ae)(function(t){function a(){return Object(s.a)(this,a),Object(l.a)(this,Object(u.a)(a).apply(this,arguments))}return Object(m.a)(a,t),Object(o.a)(a,[{key:"render",value:function(){return r.a.createElement(e,this.props)}}]),a}(r.a.Component))}(ne),pe=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("form",{className:"mb-3"},r.a.createElement(z,null),r.a.createElement(ee,null),r.a.createElement(ue,null),r.a.createElement(me,null))}}]),t}(n.Component),de=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"d-flex justify-content-center"},r.a.createElement("div",{className:"lds-spinner"},r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null)))}}]),t}(n.Component),he=function(e){var t=e.movies;return{movies:t.data,total_pages:t.total_pages,filters:t.filters,page:t.page,isFetching:t.isFetching,success:t.success}},ve=function(e){return Object(j.bindActionCreators)({getMovies:P,changePage:L},e)},be=a(22),fe=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props,t=e.marked,a=e.changeMark;return r.a.createElement("div",{onClick:a},r.a.createElement(be.a,{icon:[t?"fas":"far","heart"]}))}}]),t}(r.a.Component),ge=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props,t=e.marked,a=e.changeMark;return r.a.createElement("div",{onClick:a},r.a.createElement(be.a,{icon:[t?"fas":"far","bookmark"]}))}}]),t}(r.a.Component);function Ee(e,t){return-1!==t.findIndex(function(t){return String(t.id)===String(e)})}var Oe=function(e){return{user:e.authentication.user,session_id:e.authentication.session_id,isAuth:e.authentication.isAuth,watchlist:e.account.watchlist,favorite:e.account.favorite}},je=function(e){return Object(j.bindActionCreators)({toggleLoginForm:S,getFavorite:N,getWatchlist:C},e)},ye=function(e,t){return Object(y.b)(Oe,je)(function(a){function n(e){var a;Object(s.a)(this,n);return(a=Object(l.a)(this,Object(u.a)(n).call(this,e))).state={marked:function(e){switch(e){case"favorite":return Ee(a.props.id,a.props.favorite);case"watchlist":return Ee(a.props.id,a.props.watchlist);default:return!1}}(t)},a.changeMark=a.changeMark.bind(Object(x.a)(Object(x.a)(a))),a}return Object(m.a)(n,a),Object(o.a)(n,[{key:"fetchMark",value:function(){var e=this,a=this.props,n=a.getFavorite,r=a.getWatchlist,c=a.session_id,i=a.user;switch(t){default:break;case"favorite":!function(){var t={session_id:e.props.session_id},a={media_type:"movie",media_id:e.props.id,favorite:e.state.marked};O.post("/account/".concat(e.props.id,"/favorite"),{params:t,body:a}).then(function(){n({session_id:c,user_id:i.id})})}();break;case"watchlist":!function(){var t={session_id:e.props.session_id},a={media_type:"movie",media_id:e.props.id,watchlist:e.state.marked};O.post("/account/".concat(e.props.id,"/watchlist"),{params:t,body:a}).then(r({session_id:c,user_id:i.id}))}()}}},{key:"changeMark",value:function(){this.props.user?this.setState({marked:!this.state.marked},this.fetchMark):this.props.toggleLoginForm()}},{key:"componentDidUpdate",value:function(e){var a=[];switch(t){case"favorite":a=this.props.favorite;break;case"watchlist":a=this.props.watchlist}(this.props.isAuth&&!Q.a.isEqual(e.favorite,this.props.favorite)||!Q.a.isEqual(e.watchlist,this.props.watchlist)&&this.props.isAuth)&&this.setState({marked:Ee(this.props.id,a)})}},{key:"render",value:function(){var t=this.state.marked;return r.a.createElement(e,{marked:t,changeMark:this.changeMark})}}]),n}(r.a.Component))},_e=ye(fe,"favorite"),ke=ye(ge,"watchlist"),we=function(e){return function(t){function a(){return Object(s.a)(this,a),Object(l.a)(this,Object(u.a)(a).apply(this,arguments))}return Object(m.a)(a,t),Object(o.a)(a,[{key:"render",value:function(){var t=this;return r.a.createElement(ot.Consumer,null,function(a){return r.a.createElement(e,Object.assign({},t.props,a))})}}]),a}(r.a.Component)}(function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props.item;return r.a.createElement("div",{className:"card",style:{width:"100%"}},r.a.createElement("img",{className:"card-img-top card-img--height",src:"https://image.tmdb.org/t/p/w500".concat(e.backdrop_path||e.poster_path),alt:""}),r.a.createElement("div",{className:"card-body shadow-sm"},r.a.createElement(H.a,{to:"/movie/".concat(e.id)},e.title),r.a.createElement("div",{className:"card-text"},"\u0420\u0435\u0439\u0442\u0438\u043d\u0433:",e.vote_average),r.a.createElement("div",{className:"movie-item__like float-right ml-2"},r.a.createElement(ke,{id:e.id})),r.a.createElement("div",{className:"movie-item__like float-right"},r.a.createElement(_e,{id:e.id}))))}}]),t}(r.a.Component)),Ne=function(e){var t=e.movies,a=void 0===t?[]:t,n=e.success,c=(e.error,e.col),i=void 0===c?"col-6":c;return n&&0===a.length?r.a.createElement("h1",null,"No Movies"):r.a.createElement("div",{className:"row"},a.map(function(e){return r.a.createElement("div",{key:e.id,className:"".concat(i," mb-4")},r.a.createElement(we,{item:e}))}))},Ce=function(e){return Object(y.b)(he,ve)(function(t){function a(){return Object(s.a)(this,a),Object(l.a)(this,Object(u.a)(a).apply(this,arguments))}return Object(m.a)(a,t),Object(o.a)(a,[{key:"componentDidMount",value:function(){this.props.getMovies(this.props.filters,1)}},{key:"render",value:function(){return this.props.isFetching?r.a.createElement(de,null):r.a.createElement(e,Object.assign({},this.props,{movies:this.props.movies,success:this.props.success,error:this.props.error}))}}]),a}(r.a.PureComponent))}(Ne),Ae=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props.resetFilters;return r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row mt-4"},r.a.createElement("div",{className:"col-4"},r.a.createElement("div",{className:"card",style:{width:"100%"}},r.a.createElement("div",{className:"card-body"},r.a.createElement("h3",null,"\u0424\u0438\u043b\u044c\u0442\u0440\u044b:"),r.a.createElement("div",{className:"mb-4"},r.a.createElement("button",{className:"btn btn-light border",onClick:e},"\u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c \u0444\u0438\u043b\u044c\u0440\u044b")),r.a.createElement(pe,null)))),r.a.createElement("div",{className:"col-8"},r.a.createElement(Ce,null))))}}]),t}(r.a.Component),Fe=Object(y.b)(function(){return{}},function(e){return Object(j.bindActionCreators)({resetFilters:T},e)})(Ae),Se=a(139),Me=a(59),Le=a.n(Me),Pe=(a(80),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).handleHover=function(e){a.setState({hoverRating:e})},a.onLeaveDropDown=function(){a.setState({hoverRating:a.state.rated})},a.setRating=function(e){var t=a.props,n=t.session_id,r=t.match.params.id;a.setState({rated:e},function(){var t={session_id:n},a={value:2*e};O.post("/movie/".concat(r,"/rating"),{params:t,body:a})})},a.createStars=function(){for(var e=[],t=function(t){e.push(r.a.createElement("div",{className:"rating-btn__star",onMouseEnter:function(){return a.handleHover(t)},onClick:function(){return a.setRating(t)},key:t},r.a.createElement(be.a,{icon:[t<=a.state.hoverRating?"fas":"far","star"],color:t<=a.state.rated?"black":"gray"})))},n=1;n<6;n++)t(n);return e},a.toggle=a.toggle.bind(Object(x.a)(Object(x.a)(a))),a.state={dropdownRating:!1,rated:null,hoverRating:null,favorite:null,watchlist:null},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"toggle",value:function(){var e=this,t=this.props,a=t.toggleLoginForm;t.isAuth?this.setState(function(t){return{dropdownRating:!t.dropdownRating,rating:e.state.rated}}):a()}},{key:"getAccountState",value:function(){var e=this,t=this.props,a=t.session_id,n=t.match.params.id,r={session_id:a};O.get("/movie/".concat(n,"/account_states"),{params:r}).then(function(t){e.setState({rated:t.rated.value/2,hoverRating:t.rated.value/2})})}},{key:"componentDidMount",value:function(){this.getAccountState()}},{key:"render",value:function(){var e,t=this;return r.a.createElement(p.a,{isOpen:this.state.dropdownRating,toggle:this.toggle},r.a.createElement(p.c,{className:"rating-btn",tag:"div"},r.a.createElement(be.a,{icon:[this.state.rated?"fas":"far","star"]}),this.state.rated?r.a.createElement("div",{className:"rating-btn__your-rating"},"\u0412\u0430\u0448 \u0440\u0435\u0439\u0442\u0438\u043d\u0433 : ",(e=this.state.rated,r.a.createElement("div",{className:"rating-btn__circle"},r.a.createElement(Le.a,{percentage:2*e*10,text:"".concat(2*e),style:{path:{fill:"#3987e0"},text:{fill:"#3987e0"}},initialAnimation:!0})))):null),r.a.createElement(p.b,{className:"rating-btn__drop",onMouseLeave:function(){return t.onLeaveDropDown()}},r.a.createElement("div",{className:"rating-btn__inner"},this.createStars())))}}]),t}(n.Component)),Re=Object(y.b)(function(e){var t=e.authentication;return{session_id:t.session_id,isAuth:t.isAuth}},function(e){return Object(j.bindActionCreators)({toggleLoginForm:S},e)})(Object(Se.a)(Pe)),Te=a(135),De=a(138),Ge=a(129),Ie=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={backdrops:[],posters:[]},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.id;O.get("/movie/".concat(t,"/images")).then(function(t){e.setState({backdrops:t.backdrops,posters:t.posters})})}},{key:"render",value:function(){var e=this.state,t=e.backdrops,a=e.posters;return r.a.createElement("div",null,r.a.createElement("div",null,t.map(function(e){return r.a.createElement("span",null,e)})),r.a.createElement("div",null,a.map(function(e){return r.a.createElement("span",null,e)})))}}]),t}(n.Component),Ue=Object(Se.a)(Ie),xe=function(e){return function(t){function a(e){var t;return Object(s.a)(this,a),(t=Object(l.a)(this,Object(u.a)(a).call(this,e))).state={page:e.page,total_pages:e.total_pages},t}return Object(m.a)(a,t),Object(o.a)(a,[{key:"render",value:function(){return r.a.createElement(e,this.props)}}]),a}(r.a.Component)}(ne),He=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).onChangePage=function(e){e=e>=0?e<=a.state.total_pages?e:a.state.total_pages:0,a.setState({page:e},function(){a.getMovies(e)})},a.getMovies=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=a.props.match.params.id,n={page:e};a.setState({isFetching:!0}),O.get("/movie/".concat(t,"/similar"),{params:n}).then(function(e){a.setState({movies:e.results,total_pages:e.total_pages,total_results:e.total_results,page:e.page,isFetching:!1})})},a.state={movies:[],total_pages:null,total_results:null,page:null,isFetching:!1},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.getMovies()}},{key:"render",value:function(){var e=this.state,t=e.movies,a=e.isFetching,n=e.page,c=e.total_pages;return r.a.createElement("div",{className:"mt-4"},r.a.createElement(xe,{onChangePage:this.onChangePage,page:n,total_pages:c,mode:"inline"}),r.a.createElement("div",{className:"mt-4"},a?r.a.createElement(de,null):t.length?r.a.createElement(Ne,{movies:t,col:"col-4"}):r.a.createElement("p",{className:"text-center"},"\u041d\u0435\u0442 \u043f\u043e\u0445\u043e\u0436\u0438\u0445 \u0444\u0438\u043b\u044c\u043c\u043e\u0432")))}}]),t}(n.Component),We=Object(Se.a)(He),Be=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={movies:[]},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props.movie;return r.a.createElement("div",{className:"mt-4"},r.a.createElement("table",{className:"table"},r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("th",{scope:"row"},"\u0421\u0442\u0430\u0442\u0443\u0441 "),r.a.createElement("td",null,e.status)),r.a.createElement("tr",null,r.a.createElement("th",{scope:"row"},"\u0414\u0430\u0442\u0430 \u0432\u044b\u0445\u043e\u0434\u0430"),r.a.createElement("td",null,e.release_date)),r.a.createElement("tr",null,r.a.createElement("th",{scope:"row"},"\u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c"),r.a.createElement("td",null,e.runtime," \u043c\u0438\u043d\u0443\u0442")),r.a.createElement("tr",null,r.a.createElement("th",{scope:"row"},"\u042f\u0437\u044b\u043a \u043e\u0440\u0438\u0433\u0438\u043d\u0430\u043b\u0430"),r.a.createElement("td",null,e.original_language)),r.a.createElement("tr",null,r.a.createElement("th",{scope:"row"},"\u0421\u0442\u0440\u0430\u043d\u0430"),r.a.createElement("td",null,e.production_countries.map(function(e,t){return r.a.createElement("span",{key:t},e.name)}))),r.a.createElement("tr",null,r.a.createElement("th",{scope:"row"},"\u0411\u044e\u0434\u0436\u0435\u0442"),r.a.createElement("td",null,e.budget,"$")),r.a.createElement("tr",null,r.a.createElement("th",{scope:"row"},"\u0421\u0431\u043e\u0440\u044b"),r.a.createElement("td",null,e.revenue,"$")),r.a.createElement("tr",null,r.a.createElement("th",{scope:"row"},"\u041a\u043e\u043c\u043f\u0430\u043d\u0438\u044f"),r.a.createElement("td",null,e.production_companies.map(function(e){return r.a.createElement("div",{key:e.id},r.a.createElement("span",{className:"badge badge-info mr-4"},e.name))}))),r.a.createElement("tr",null,r.a.createElement("th",{scope:"row"},"\u0416\u0430\u043d\u0440\u044b"),r.a.createElement("td",null,e.genres.map(function(e){return r.a.createElement("div",{key:e.id},r.a.createElement("span",{className:"badge badge-info mr-4"},e.name))}))))))}}]),t}(n.Component),qe=a(60),Ve=a.n(qe),Je=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).getActorsList=function(){var e=a.props.match.params.id;a.setState({isFetching:!0}),O.get("/movie/".concat(e,"/credits")).then(function(e){var t=e.cast.filter(function(e){return e.profile_path});a.setState({actor_gallery:t.map(function(e){return{src:"https://image.tmdb.org/t/p/w500/".concat(e.profile_path),thumbnail:"https://image.tmdb.org/t/p/w500/".concat(e.profile_path),thumbnailWidth:120,thumbnailHeight:180,caption:e.character}}),isFetching:!1})})},a.state={actor_gallery:[],isFetching:!1},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.getActorsList()}},{key:"render",value:function(){var e=this.state,t=e.actor_gallery,a=e.isFetching;return r.a.createElement("div",{className:"mt-4"},a?r.a.createElement(de,null):t.length?r.a.createElement(Ve.a,{images:t,enableImageSelection:!1}):r.a.createElement("p",{className:"text-center"},"\u0410\u043a\u0442\u0435\u0440\u044b \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u044b"))}}]),t}(n.Component),$e=Object(Se.a)(Je),ze=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props,t=e.movie,a=e.match.params.id;return r.a.createElement("div",null,r.a.createElement("ul",{className:"nav nav-tabs"},r.a.createElement("li",{className:"nav-item"},r.a.createElement(Te.a,{to:"/movie/".concat(a,"/details"),className:"nav-link"},"\u0414\u0435\u0442\u0430\u043b\u0438")),r.a.createElement("li",{className:"nav-item"},r.a.createElement(Te.a,{to:"/movie/".concat(a,"/similar"),className:"nav-link"},"\u041f\u043e\u0445\u043e\u0436\u0438\u0435 \u0444\u0438\u043b\u044c\u043c\u044b")),r.a.createElement("li",{className:"nav-item"},r.a.createElement(Te.a,{to:"/movie/".concat(a,"/actors"),className:"nav-link",activeClassName:"active"},"\u0410\u043a\u0442\u0435\u0440\u044b"))),r.a.createElement("div",{className:"tab-content"},r.a.createElement(De.a,null,r.a.createElement(Ge.a,{path:"/movie/:id/images",component:function(){return r.a.createElement(Ue,null)}}),r.a.createElement(Ge.a,{path:"/movie/:id/similar",component:function(){return r.a.createElement(We,null)}}),r.a.createElement(Ge.a,{path:"/movie/:id/details",component:function(){return r.a.createElement(Be,{movie:t})}}),r.a.createElement(Ge.a,{path:"/movie/:id/actors",component:function(){return r.a.createElement($e,{movie:t})}}))))}}]),t}(n.Component),Ke=Object(Se.a)(ze),Qe=ye(fe,"favorite"),Xe=ye(ge,"watchlist"),Ye=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={movie:null},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;O.get("/movie/".concat(this.props.match.params.id)).then(function(t){e.setState({movie:t})})}},{key:"render",value:function(){var e=this.state.movie,t=this.props.match.params.id;return e&&r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row mt-4"},r.a.createElement("div",{className:"col-4"},r.a.createElement("img",{className:"card-img-top card-img--height",src:"https://image.tmdb.org/t/p/w500".concat(e&&e.backdrop_path||e&&e.poster_path),alt:""})),r.a.createElement("div",{className:"col-8"},r.a.createElement("h2",{className:"title mb-4"},e&&e.title),r.a.createElement("p",{className:"mb-4"},e&&e.overview),r.a.createElement("span",null,"\u0420\u0435\u0439\u0442\u0438\u043d\u0433 \u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439: ",e.vote_average),r.a.createElement("div",null,r.a.createElement("div",{className:"movie-item__like float-right ml-2"},r.a.createElement(Xe,{id:t})),r.a.createElement("div",{className:"movie-item__like float-right"},r.a.createElement(Qe,{id:t})),r.a.createElement("div",{className:"movie-item__star"},r.a.createElement(Re,null))))),r.a.createElement("div",{className:"row mt-4"},r.a.createElement("div",{className:"col-12"},r.a.createElement(Ke,{movie:e}))))}}]),t}(r.a.Component),Ze=a(136),et=a(137),tt=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return this.props.isAuth?r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row mt-4"},r.a.createElement(Ne,{movies:this.props.favorite,col:"col-4"}))):r.a.createElement(et.a,{to:"/"})}}]),t}(n.Component),at=Object(y.b)(function(e){return{isAuth:e.authentication.isAuth,session_id:e.authentication.session_id,user:e.authentication.user,favorite:e.account.favorite}},function(e){return Object(j.bindActionCreators)({getFavorites:N},e)})(tt),nt=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return this.props.isAuth?r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row mt-4"},r.a.createElement(Ne,{movies:this.props.watchlist,col:"col-4"}))):r.a.createElement(et.a,{to:"/"})}}]),t}(n.Component),rt=Object(y.b)(function(e){return{isAuth:e.authentication.isAuth,session_id:e.authentication.session_id,user:e.authentication.user,watchlist:e.account.watchlist}},function(e){return Object(j.bindActionCreators)({getWatchlist:C},e)})(nt),ct=a(27),it=a(28),st=a(36);ct.b.add(it.b,st.b,it.a,st.a,it.c,it.d,st.c);var ot=r.a.createContext(),lt=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.session_id,a=e.getAccount;t&&a({session_id:t})}},{key:"render",value:function(){var e=this.props,t=e.user,a=e.session_id,n=e.isAuth;return a&&n||!a?r.a.createElement(Ze.a,null,r.a.createElement("div",null,r.a.createElement(J,{user:t}),r.a.createElement(Ge.a,{exact:!0,path:"/",component:Fe}),r.a.createElement(Ge.a,{path:"/movie/:id",component:Ye}),r.a.createElement(Ge.a,{path:"/account/favorites",component:at}),r.a.createElement(Ge.a,{path:"/account/watchlist",component:rt}))):r.a.createElement("p",null,"Loading...")}}]),t}(r.a.Component),ut=Object(y.b)(function(e){return{session_id:e.authentication.session_id,isAuth:e.authentication.isAuth,user:e.authentication.user}},function(e){return Object(j.bindActionCreators)({getAccount:_},e)})(lt),mt=(a(130),a(132),new(a(63).a)),pt={user:null,isAuth:!1,session_id:mt.get("session_id")},dt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_AUTH":return mt.set("session_id",t.payload.session_id,{path:"/",maxAge:2592e3}),Object(h.a)({},e,{user:t.payload.user,session_id:t.payload.session_id,isAuth:!0});case"LOG_OUT":return mt.remove("session_id"),Object(h.a)({},e,{user:null,session_id:null,isAuth:!1});default:return e}},ht={filters:{sort_by:"popularity.desc",primary_release_year:"0",with_genres:[]}},vt=Object(h.a)({},ht,{data:[],page:null,total_pages:null,success:null,isFetching:!1,error:!1}),bt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCHING_MOVIES":return Object(h.a)({},e,{isFetching:!0});case"UPDATE_MOVIES":return Object(h.a)({},e,{data:t.payload.results,page:t.payload.page,total_pages:t.payload.total_pages,isFetching:!1,success:!0});case"CHANGE_PAGE":return Object(h.a)({},e,{page:t.payload});case"UPDATE_FILTERS":return Object(h.a)({},e,{filters:Object(h.a)({},e.filters,t.payload)});case"RESET_FILTERS":return Object(h.a)({},e,ht);default:return e}},ft={showLoginForm:!1},gt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ft;switch((arguments.length>1?arguments[1]:void 0).type){case"TOGGLE_LOGIN_FORM":return Object(h.a)({},e,{showLoginForm:!e.showLoginForm});case"HIDE_LOGIN_FORM":return Object(h.a)({},e,{showLoginForm:!1});default:return e}},Et={favorite:[],watchlist:[]},Ot=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Et,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_FAVORITE":return Object(h.a)({},e,{favorite:t.payload});case"UPDATE_WATCHLIST":return Object(h.a)({},e,{watchlist:t.payload});default:return e}},jt=Object(j.combineReducers)({authentication:dt,account:Ot,movies:bt,modals:gt}),yt=a(61),_t=[function(e){e.getState;var t=e.dispatch;return function(e){return function(a){return"UPDATE_AUTH"===a.type&&(t(N({session_id:a.payload.session_id,user_id:a.payload.user.id})),t(C({session_id:a.payload.session_id,user_id:a.payload.user.id}))),e(a)}}},function(e){var t=e.getState,a=e.dispatch;return function(e){return function(n){if("UPDATE_FILTERS"===n.type&&a(P(Object(h.a)({},t().movies.filters,n.payload),1)),"CHANGE_PAGE"===n.type){var r=t().movies.filters,c=n.payload;a(P(r,c))}return"RESET_FILTERS"===n.type&&a(P(vt.filters,1)),e(n)}}}],kt=Object(j.createStore)(jt,{},Object(yt.composeWithDevTools)(j.applyMiddleware.apply(void 0,[function(e){e.getState;var t=e.dispatch;return function(e){return function(a){if("function"!==typeof a)return e(a);a(t)}}}].concat(_t))));window.store=kt,i.a.render(r.a.createElement(y.a,{store:kt},r.a.createElement(ut,null)),document.getElementById("root"))},64:function(e,t,a){e.exports=a(134)}},[[64,2,1]]]);
//# sourceMappingURL=main.49b8de5a.chunk.js.map